In Spring, when you have multiple beans of the same type and do not use `@Primary`, the Spring container will not know which bean to inject when there is an ambiguous reference. This can lead to a `NoSuchBeanDefinitionException` or an `UnsatisfiedDependencyException`.

This document covers two examples:
1. **Multiple Data Sources Configuration**: Using `@Primary` and `@Qualifier` annotations for handling different data sources (Oracle, PostgreSQL, MongoDB).
2. **Booking System Scenario**: A booking system with common and specific booking types (Hotel and Flight booking).

---

## 1. Multiple Data Sources Configuration

In a Spring application, you may need to define multiple data sources (e.g., Oracle, PostgreSQL, and MongoDB). We use `@Primary` to mark one as the default, and `@Qualifier` to inject a specific data source when needed.

### DataSource Configuration Example

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import javax.sql.DataSource;
import org.apache.commons.dbcp2.BasicDataSource;

@Configuration
public class DataSourceConfig {

    @Bean
    @Primary // Marks Oracle DataSource as the default
    public DataSource oracleDataSource() {
        BasicDataSource dataSource = new BasicDataSource();
        dataSource.setDriverClassName("oracle.jdbc.driver.OracleDriver");
        dataSource.setUrl("jdbc:oracle:thin:@localhost:1521:orcl");
        dataSource.setUsername("oracle_user");
        dataSource.setPassword("oracle_password");
        return dataSource;
    }

    @Bean
    public DataSource postgresDataSource() {
        BasicDataSource dataSource = new BasicDataSource();
        dataSource.setDriverClassName("org.postgresql.Driver");
        dataSource.setUrl("jdbc:postgresql://localhost:5432/postgresdb");
        dataSource.setUsername("postgres_user");
        dataSource.setPassword("postgres_password");
        return dataSource;
    }

    @Bean
    public DataSource mongoDataSource() {
        BasicDataSource dataSource = new BasicDataSource();
        dataSource.setDriverClassName("mongodb.jdbc.MongoDriver");
        dataSource.setUrl("jdbc:mongodb://localhost:27017/mydb");
        dataSource.setUsername("mongo_user");
        dataSource.setPassword("mongo_password");
        return dataSource;
    }
}
```

### Using Data Sources in a Service

In a service, you can inject the `DataSource` with `@Primary` for the default or use `@Qualifier` for a specific data source.

```java
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;
import javax.sql.DataSource;

@Service
public class DataSourceService {

    private final DataSource defaultDataSource;
    private final DataSource postgresDataSource;
    private final DataSource mongoDataSource;

    public DataSourceService(
            DataSource defaultDataSource, // Will inject the primary (Oracle) datasource
            @Qualifier("postgresDataSource") DataSource postgresDataSource, // Injects the PostgreSQL datasource
            @Qualifier("mongoDataSource") DataSource mongoDataSource // Injects the MongoDB datasource
    ) {
        this.defaultDataSource = defaultDataSource;
        this.postgresDataSource = postgresDataSource;
        this.mongoDataSource = mongoDataSource;
    }

    public void connectToDefaultDataSource() {
        // Connect using Oracle DataSource (primary)
    }

    public void connectToPostgresDataSource() {
        // Connect using PostgreSQL DataSource (via @Qualifier)
    }

    public void connectToMongoDataSource() {
        // Connect using MongoDB DataSource (via @Qualifier)
    }
}
```

### Testing with a client
```java
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class DBClient {

    public static void main(String[] args) {
        ApplicationContext context = new AnnotationConfigApplicationContext(DataSourceConfig.class);
        DataSourceService dataSourceService = context.getBean(DataSourceService.class);
        
        dataSourceService.connectToDefaultDataSource(); // Connect to Oracle
        dataSourceService.connectToPostgresDataSource(); // Connect to PostgreSQL
        dataSourceService.connectToMongoDataSource(); // Connect to MongoDB
    }
}

```

---

## 2. Booking System Scenario

This booking system demonstrates common and specific booking functionality using interfaces and inheritance in Spring. We have:
- **`Booking` Interface**: Common functionality for booking.
- **`HotelBooking`** and **`FlightBooking`**: Specific implementations for hotel and flight bookings.
- **`BookingService`**: A service to handle both types of bookings using `@Qualifier` to distinguish between them.

### Common `Booking` Interface

```java
public interface Booking {
    void book();
}
```

### Hotel Booking Implementation

```java
import org.springframework.stereotype.Component;

@Component
public class HotelBooking implements Booking {

    @Override
    public void book() {
        System.out.println("Hotel booking confirmed!");
        // Logic for booking a hotel
    }
}
```

### Flight Booking Implementation

```java
import org.springframework.stereotype.Component;

@Component
public class FlightBooking implements Booking {

    @Override
    public void book() {
        System.out.println("Flight booking confirmed!");
        // Logic for booking a flight
    }
}
```

### Booking Service

```java
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;

@Service
public class BookingService {

    private final Booking hotelBooking;
    private final Booking flightBooking;

    // Using @Qualifier to inject specific booking types
    public BookingService(@Qualifier("hotelBooking") Booking hotelBooking, 
                          @Qualifier("flightBooking") Booking flightBooking) {
        this.hotelBooking = hotelBooking;
        this.flightBooking = flightBooking;
    }

    public void bookHotel() {
        hotelBooking.book();  // Hotel booking logic
    }

    public void bookFlight() {
        flightBooking.book();  // Flight booking logic
    }
}
```

### Main Application

```java
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Bean;

@SpringBootApplication
public class BookingApplication {

    public static void main(String[] args) {
        SpringApplication.run(BookingApplication.class, args);
    }

    @Bean
    public CommandLineRunner run(ApplicationContext ctx) {
        return args -> {
            BookingService bookingService = ctx.getBean(BookingService.class);
            
            // Simulate booking a hotel
            System.out.println("Processing Hotel Booking:");
            bookingService.bookHotel();
            
            // Simulate booking a flight
            System.out.println("Processing Flight Booking:");
            bookingService.bookFlight();
        };
    }
}
```

---

## Summary

1. **Multiple Data Sources**:
    - Use `@Primary` to mark the default data source.
    - Use `@Qualifier` to inject specific data sources as needed.

2. **Booking System**:
    - Common functionality is defined in the `Booking` interface.
    - Specific booking implementations (e.g., `HotelBooking`, `FlightBooking`) inherit from `Booking`.
    - Use `@Qualifier` to inject specific booking types into the `BookingService`.
